function [Y,Xf,Af] = NeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 21-Jun-2017 10:20:00.
% 
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 200xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_remove = [25 26 27 34 35 36 37 38 39 40 41 67 68 69 90 91 92 93 118 119 120 146 147 148 156 157 158];
  x1_step1_keep = [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 28 29 30 31 32 33 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 149 150 151 152 153 154 155 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200];
  x1_step2_xoffset = [0.00468653472004465;0.00368240806958892;0.00352533804974059;0.00565650307419489;0.00703543232596012;0.00685948284730838;0.0101760443052441;0.00984440249010129;0.00732169588263101;0.00279674304199349;0.00253179543981803;0.00324944242701958;0.00305316947670963;0.00308810203488319;0.0130607251305602;0.014298517297793;0.0137598006163927;0.0145012240332483;0.0151816163391994;0.0100454395288786;0.00564601700323343;0.00351986903946746;0.014123908126183;0;0;0.000888417557204874;0.00111156074071411;0.000941811770041585;0.00247926724552513;0;0;0.0421661916305857;0.0338607040243562;0.0332162595699666;0.0343709694653248;0.00551964885195833;0.00511543688494293;0.00500915162670423;0.0038165606297928;0.00446800968599292;0.00542200467585814;0.00515457897022572;0.00457269575685967;0.00424500883785691;0.00507278010640702;0.00629303947189972;0.00498618510089768;0.0055660890059615;0.00603114814758176;0.00721321646520427;0.0219939705209519;0.0237106908061832;0.0238469345427147;0.0293840295103161;0;0;0.0219572656240183;0.00582682029742259;0.0248330085409822;0.019913626180034;0.00649310411236143;0.00450258382687377;0.00473793080849702;0.0073662110555625;0.00667816936725155;0.00356730677675279;0.00351953458696202;0.0027766727516636;0.00294961141551234;0.00298087702195269;0.0262342095625846;0.0129825062774075;0.0186250817406152;0.0100350485901173;0;0;0.00280371170901052;0.0041048789082286;0.00185624644790809;0.00329941947609616;0.00737316480820997;0.00648282279023613;0.00343295968766144;0.0066324428370698;0.0068892634663642;0.00658589067124382;0.00774750404050074;0.00645545518256682;0.00654048946028744;0.00259661226417022;0.00562997254590774;0.0048377315461755;0.00394697316593415;0.00124434122481899;0.0233165955350013;0.0212468889078352;0.0191501023851936;0.0172062769328852;0;0;0.0227087301820797;0.0251825046343876;0.0222503549762781;0.0113163484759485;0.0146939200427405;0.0143453755665893;0.0102807199266544;0.0136520812321084;0.0138567016468995;0.0021015375034249;0.00215731971799788;0.00163870072182629;0.00257062340027862;0.00323282400857944;0.0255948146891571;0.0281800806540794;0.0226704154266093;0.0220230943830057;0.0170426571967697;0.0308274145573043;0.032068260525582;0.0249279498347533;0.0238516071090339;0;0;0.0219981162850218;0.0149436642133897;0.00387452648026174;0.0046289537616975;0.00968401847474992;0;0;0.0042258688917087;0.00346376643442966;0.00294312143711955;0.00332982687660673;0.0110559023029259;0.00976187548035192;0.00783308451561427;0.0125460610361827;0.00040384481937425;0.00392638142447647;0.00396443019974175;0.00514986443213381;0.0040937814058861;0.00494396968303593;0.00387918372591575;0.00700314269907084;0.00674044717882402;0.00775540015219542;0.00467686120129639;0.00639146689454224;0.00452161776261435;0.0055873357506486;0.0026283796869849;0.00200106178565674;0.00142403667643951;0.00141305790553955;0.00224167102152699;0.00290362392984068;0.010859645594235;0.0051747646913434;0.00688169257082114;0.00492133436764945;0.00348856006412595;0.00482004586663209;0.00874946262317773;0.00660978257092029;0.00466415696982635;0.00540251784084996;0.00509325303113964;0.00422467779864559;0.00417655460694309];
  x1_step2_gain = [0.456644507297843;0.391975001097832;0.39379343158538;0.369889580371051;0.472970516980332;0.899579320461769;0.674101162530063;0.964533746533433;0.768110318499977;0.584467314794716;0.581801755320615;0.548888380312213;0.556668587151946;0.621458241927063;0.378690118527709;0.372731552093686;0.651767378845343;0.389581150306257;0.331943900614399;0.46414766756717;0.495052171643908;1.09765237412842;0.552435894798935;0.45448845338138;2.33669417624462;1.67427309192421;1.70995858796602;1.75931922153871;2.0296291942554;1.93427653516979;0.775927896402741;0.636538406204127;0.658270807509572;0.625713971090935;0.576644223479559;0.465668460755181;0.468879601515516;0.516810360683793;0.550871467364391;0.569275103966138;0.533834682437554;0.597087099850939;0.594072175196976;0.660890033531403;0.584826158708811;0.59063874659903;0.623043825008484;0.568810600828072;0.555473101355234;0.481304852482788;0.532222724433928;0.493372004761312;0.497152152440599;0.48982215264711;0.705927367449712;0.50788717397982;0.380711076551452;0.296861637334168;0.442456404477532;0.837090134237019;0.43582506379408;0.574138408077744;0.547748545715153;0.518171588134884;0.514872853704304;0.505215336463166;0.691233690410905;0.692678598021943;0.672191075798245;0.450320352267565;0.449116500375133;0.536219025731366;0.432685654727963;0.500932303895276;0.528750492583839;0.398151911411114;0.354447338496358;0.321702627928037;0.334338225593996;0.329346872170059;0.508936153285098;0.503474627753636;0.542514491971974;0.514506238725531;0.498389773282429;0.521326752342053;0.451368938684153;0.553809342439196;0.525174757512832;0.509751983680093;0.459092793624765;0.423088524415484;0.244006277648612;0.605320421131294;0.575387299585431;0.562461950005736;0.634810648797432;0.672363597456188;0.732861574368413;0.405622056737818;0.343494762918598;0.400115937941066;0.38536951668;0.411956515876741;0.381340678727464;0.606300436937852;0.491176703508881;0.600543465502392;0.672682623578187;0.638559983028628;0.683013226884587;0.657367416421081;0.696297041178426;0.627519214986775;0.633928336016245;0.685236143237717;0.584687089562661;0.660618184001106;0.849903621012863;0.832773644030958;0.819127285346874;0.849140653293631;0.844593776121609;0.94750782066395;1.79110767450818;1.21434910212648;0.199024756726401;0.264083329195664;0.142016700757608;0.587569438236704;0.566034007428433;0.524434046384879;0.536762791034674;0.590771830324049;0.603004968060061;0.592536638367396;0.518537642900954;0.567404213809772;0.481144305001996;0.465193757291036;0.468458810846298;0.501067903358551;0.476643529305351;0.529458763025796;0.564543409569663;0.431170912023399;0.716223749672621;0.569172171004188;0.435748026887801;0.465741404940155;0.552952625017469;0.538104862527432;0.547372284683602;0.5096651755135;0.571389814883244;0.228421016990016;0.252460701251503;0.257541306539955;0.305176832495303;0.391424304956552;0.461841808907506;0.408810241562956;0.853239808785038;0.478978277331881;0.435264692631449;0.4816041714444;0.47611487610991;0.518691527824912;0.658233072994021;0.591111791396833;0.597149584368498;0.544581423230891;0.592504493982768];
  x1_step2_ymin = -1;
  
  % Layer 1
  b1 = [1.4036388560789403;-1.095480797218269;-0.73506505637144137;-0.37659186413918883;-0.17158130339440439;0.1312066763413085;-0.41669364501526113;0.82603413986657703;-1.0451178893792856;1.4363154838015286];
  IW1_1 = [-0.16896531296626599 -0.20528164080320047 -0.031931433527658142 0.067276967169867682 -0.082169318148096013 -0.087478538060971334 0.14104072650592145 -0.17130998644287965 0.13039304184626729 -0.21514530027948753 0.19595192489312224 0.14678458572715161 0.062985321005345429 -0.18870084083186622 -0.027941359684022102 -0.076326314737829151 -0.062528723134906705 0.095800813754257017 -0.033963379205061622 -0.077597418282292815 0.1883439545687528 -0.11763495937208736 -0.082816052786897895 0.14503936327703815 0.15614042751321425 0.057537116437967016 0.1149615555873012 -0.096179264176895402 0.066747998380635068 0.029037674376612178 -0.047733545697217411 -0.01318083014571386 0.14314924903643611 0.093195878991337147 0.013592091855725182 -0.036694175091477252 -0.090458871606801522 0.16536375967997657 -0.145256045198391 0.075802318048546313 -0.04592632017677039 0.18987656343844619 -0.10820345543312622 -0.18061193395723352 0.084020364377317691 0.11932183306460208 0.068273236449502131 0.0769219182845991 0.0004393646504992386 0.070929310096080236 -0.035998193466148076 -0.14166115282836111 -0.13083055922672293 -0.024462549234456739 0.0016764972724596324 0.16846539761230553 0.16385770876635361 -0.15220196285735677 0.038658906481247264 0.17542205482415829 0.049728501177130652 0.018065564179571961 0.066349428318763504 -0.13610481374076744 0.010454436840515646 -0.16379675419768883 -0.1563444155714136 -0.19428089551123012 0.15454794711319872 -5.6933202088437054e-05 -0.039716312332510544 -0.17328485179847358 -0.15339405937755524 -0.1794786842681183 -0.13944677166866207 -0.16202359171890673 0.032358006802662077 0.024649157739123462 -0.12018125488979214 -0.09687024772482955 -0.036892604778724067 -0.13568219520354163 0.1253825989953529 0.14963447048920978 -0.014224535447698755 -0.19621838310933476 -0.12646645018084496 -0.12880067134052245 -0.11493908398598457 -0.022022236743898672 -0.052272452362601633 -0.16227378633347939 0.10576613069287276 -0.011622014038119724 0.11268420703007596 0.15433169061030449 -0.093648224469791153 0.12995768905767696 -0.032918968643997321 0.10346528695790701 -0.045312981936394492 -0.17149427775048778 -0.08734652122452044 -0.15510793573057385 -0.078037917498693071 0.085659959687838197 0.0090955988298182591 0.19944604607998215 0.0810454332549745 -0.074752871007088426 -0.12408557351248102 -0.097935767635586465 -0.052303977952459134 0.059484886629821654 -0.079747444298936224 0.091034983577858136 -0.12089907746843655 0.15417533295887012 -0.016163324489868583 0.083435797832669523 -0.17018635230672555 -0.02511703406176688 -0.17693340023271129 0.046074387896612411 0.071085096479434909 0.032949528959676844 0.032715788796554519 0.17844322137563801 0.078459111403472254 -0.056293483683351374 -0.095552508403924291 0.095531436497178629 -0.080044256415502363 0.1398296657171535 0.055260652801733375 -0.063230245484559147 0.0098681830840808577 -0.027097846914304967 0.045682624306857218 -0.045203600054277725 -0.0052725045375202903 -0.02852684280258596 0.010280263373601632 0.0012371575892281791 0.00043590290289906254 0.04780468084620073 0.1049046702304216 -0.029589440342447447 -0.084279506718989206 0.12485034877040402 -0.15424309598224886 -0.011861356074350052 0.059165222080804769 0.056573483521218326 0.16820196024335834 -0.094664582691462412 -0.21030785399873358 0.051958912843833763 -0.028284486129686898 0.081283034848985303 -0.073678066708126586 -0.044398201641162129 0.036252007927568539 -0.094390197527383257 0.06638917960117055 0.14012721893676039 0.12863766408175623 0.20350592728951711 0.0065860115802441055 0.083993329869803082 0.019614226750123517 0.15942291628810867 0.18133507024503481;0.058511955929827116 -0.13331215247439854 0.080034619297092907 0.0197660806522587 -0.069901540525482517 0.1218628589481404 -0.079044032893423113 0.01974291687951121 -0.081679668349130624 -0.18826166835085439 -0.22121261368751888 -0.13258678988255948 -0.065109029135609023 0.12809634578593967 -0.11243339705759192 0.067065965434508074 0.07322178105424669 -0.036904655696550492 0.059728576630786678 -0.00088024040915299058 0.063910774179327279 -0.017522964171270961 0.053433246703228889 0.19583825169171773 0.1191203561971797 -0.10838509422313022 0.013098350421336035 0.16318749747369984 -0.14532023597069543 0.08229163867416929 0.079749615709624369 -0.19789005276392696 -0.20035049579545139 0.022338257574792332 0.11465323033913558 -0.15795203793845985 0.037246311232208555 0.13296641620854285 0.045888781313758037 -0.068607452540948771 -0.17033898950633691 0.026760986215683971 0.058105497817835 0.0036853891614221082 -0.024998082137922924 -0.12431965017855023 0.051918236339184208 0.068004538840657297 0.10442063068783085 -0.015682709928631779 -0.068619825346676197 0.012899412027041582 0.037225111274159159 0.058342484983798841 0.14548415960545594 -0.10251039858032752 -0.049737181910596923 -0.14669625444563439 0.13101550608100521 -0.017928182159772682 -0.073772794923787424 0.12392071036363413 -0.18020389315042118 -0.18839780362800973 0.09607270071964237 -0.15495575667224876 0.12196938950253386 0.15778640851059272 -0.079665483707433996 0.039122335619025173 -0.19494444932521629 0.046263245282190349 -0.10749006592839763 0.13486287516776552 -0.074830075468086024 -0.16461416250278257 -0.12164780435630011 0.15468047400378995 0.10908866769807567 0.090031285944640466 -0.10058100007448577 0.094127271652615335 -0.10205576797549583 -0.17744936860132302 -0.059874323360317998 -0.041445220020016771 -0.13175675177176255 -0.10832716419331583 -0.10825604413582525 -0.1112636022964034 -0.20754172460394954 -0.035858686305182949 0.10701128448288336 -0.014178478246878349 -0.12810430899743752 0.033562315172833965 -0.22616469653928492 0.11662568156165222 0.30333892663313333 -0.060136765208017737 -0.16467082076319434 0.16251882531396653 -0.030608931167768947 0.17506166500349341 -0.053973484014170521 0.16838886815119705 0.034089140068323406 -0.088857030616064953 -0.16903633312397998 0.090392197338313787 -0.15473600411642488 -0.069314538918370541 0.13080244201886651 -0.064572922861522136 0.0083630085398073584 0.1701320080887038 0.043265561873370849 -0.11725687753287312 0.11887625265159037 -0.063284992666882325 -0.12831845449930027 -0.16886917669475035 -0.10533908752504503 0.41228526161860835 -0.096903743695245639 -0.067820430541190677 0.064584457052925565 0.01473514587144961 0.091503269919183186 -0.18368929456551797 0.21753067120251429 -0.12765805322870341 -0.026387830001486909 -0.086362558187889876 0.14679329927631751 -0.17855372491797042 -0.024533395101870421 0.026264410669621544 0.11243353277778786 0.0059365650279881565 -0.016658493299288913 0.044194472314039432 -0.086021455240855763 0.14515074140112022 -0.25273370741376294 0.088387699379955012 0.013116353233195157 -0.22371774259115607 -0.12692131970419138 -0.18502016018125234 0.023961535201351032 -0.16961662426553725 0.023743998570358714 0.093949373157076951 0.0038108976046155522 -0.18515912002785029 -0.11678114031592028 0.14776009977409418 0.030103424623913425 0.10102648486722159 -0.017896290352902331 0.18678454958324897 -0.1700376610548342 0.10743918060233711 -0.065038089414448941 -0.023436329529591016 0.14951229712245218 0.036773050100680119 0.11937569798790654 -0.12555326321114013 -0.1714763096681699 -0.094891026882848062 -0.13641676907682976;0.14910949088668052 -0.1947130604504716 0.086329728167647488 -0.15743477566757183 0.06194285416644358 -0.12584899907202454 0.025692705449274739 0.079252676828918761 -0.0037285248263975068 0.15471168202773414 0.10087229736688015 -0.10702561404451363 -0.0071623852851114408 0.1491672180078456 -0.061491443562282554 -0.20768434773869301 -0.12729764227574036 -0.051446976522190747 -0.0089821855677850743 -0.12523324520399989 -0.1753083979771374 0.062705884081603047 -0.18258561187179068 -0.20726841469178525 0.068093042112163271 0.10263414930553759 -0.036011963872952642 -0.19568514023043862 -0.18412507687536575 0.038296218768764982 0.075266165610051117 0.17049266407198957 0.073855836655780369 0.0066751836536962251 0.041015376954440824 -0.031014435262181454 -0.10916733531103714 -0.10702354188338579 -0.0414078543081828 0.11812051084207231 -0.10733286080739748 0.16079799470319742 0.10262850463407402 -0.046368146093868509 -0.15628262729359299 -0.092104907240924447 0.14472441908702244 -0.06446902084495694 -0.10500995557101646 0.075444838270603345 0.083208251498149366 -0.0046971020491852027 -0.12199355537279301 0.067694390182961847 -0.092269603543678566 0.028080053421901129 -0.1444834297652858 -0.17354063682200696 0.051894321427842123 -0.024759451607252052 0.03839672604519169 0.012452633077604046 0.033066192806551459 0.035245760030744477 0.13270978728506702 -0.16091455272460067 0.15359766201857122 -0.095116574946791002 -0.025296538416741836 0.16771473225266231 -0.00050960301386364089 0.07177577262510039 -0.18100814387129979 -0.076457902196327157 0.048150153492744256 0.020494002573889943 -0.17995059691253062 0.068758816034527062 -0.18239951985289543 0.13851965852364986 -0.17059258749279191 -0.17552939353485472 0.033490593831627523 -0.099032318458722526 0.034616447461133938 0.035077228248919394 -0.12770976978584198 -0.18236521853848972 -0.048573300225518659 0.059779567540594984 -0.0031793351445488075 -0.10936131376546866 -0.19025147313893104 0.025801666835317472 -0.0061646854631332805 0.14551715561217599 0.10231756410444894 0.10393605112963983 -0.17659726693004871 0.080215543192569447 0.016246448200748664 0.077995728503589545 -0.14268074239266437 -0.21939412828114535 -0.22475363625984643 0.087059965556215438 0.018384154398872164 0.1369724869980069 0.10263080483770377 -0.03241318970071462 -0.028418892474414002 -0.12024485662584268 0.10636392342122693 0.14750412905204469 0.16240902107412122 -0.076765804437825449 0.028724295785816312 0.077858251952372878 -0.071790851429448896 0.03711536613357657 -0.10428664037761896 -0.068219290117511072 0.060138186449055504 -0.018555258412312963 -0.1773719285363963 0.12665319689317764 -0.013481867097953924 -0.030316854880832942 0.081742478619790157 0.096721291716310748 0.041482365719544299 0.15059884683373384 0.061902290159580112 -0.10603998036417447 0.061926431619651563 0.0034566518751015306 -0.084225031811359374 0.11263659055042628 -0.016711154306661636 0.0075845719634160839 0.072699224046983715 -0.031555197408231053 -0.0076554831212183889 0.024456202743957434 0.08704551084635806 -0.18356327250545942 0.086546830715205511 -0.028620019437548053 -0.056708029597974635 -0.053487287175078183 0.13336212880316772 -0.17942323770840496 -0.13125975676898627 0.15105097548304808 -0.13649664629493544 -0.14842122838992947 0.043308066730730496 -0.0029593050126346227 -0.1222794706050972 0.16153048808834777 -0.16359006874955118 -0.073504068502221742 0.0038783464571367637 0.15558608787854603 -0.20405024940918795 0.17135068891127928 0.079316999823962675 -0.078192504894280923 -0.17841755152563013 -0.075791938081880006 -0.19124735151994648 0.051568095907149079 0.089963858460933951;0.018753153610145758 -0.14027650599644625 -0.15951952724721211 -0.18977550266157991 0.084643140223462726 0.12008889647445384 0.14507681628690575 0.13205060685568462 -0.14728090909170377 -0.086917147277778078 0.10133946205660077 -0.13087484921086273 -0.063829363410365339 -0.0022161901126814703 -0.19480873935690082 -0.17995198396846193 0.040019978140799148 -0.047707182594587907 -0.10601056264745704 0.10341498896464263 0.025081521783414277 -0.098331188551482637 0.15406406986850574 -0.23377781322601526 -0.21189645167562265 0.054268260261937581 0.10954744324794817 -0.032650846784148507 -0.014215645997342909 -0.017668206939419617 -0.20794425666371294 -0.14968958450583639 -0.081002432994778273 0.058580014807520661 -0.1246539150609835 -0.020110813896373085 0.10006881684662298 0.012992993837486509 0.038853560478310852 0.064241972390868818 -0.13341881655053656 -0.12061058305148749 -0.08456528500669519 -0.053671899450290675 -0.075910221648166812 -0.16768753293263947 -0.12932081893600109 0.050342168257040042 -0.063956649150994846 -0.0086172421967147667 0.040967295898921813 0.091253408342762479 -0.20521558974354531 -0.046768735478409845 -0.023108821311570625 -0.068855647737699352 -0.16198847032294919 0.0045816095394184027 -0.01458966987893677 0.11048140951727452 -0.1765982897971389 -0.16900358354084508 -0.075002824215444922 -0.087311164115952133 -0.11285769913805976 -0.16572646751109213 0.1507860241001433 -0.077474395403346399 -0.1852511191492148 -0.080998209747579888 -0.10116436090434459 0.019549467604137217 -0.048292126493869589 -0.071525239966300141 -0.0020000302688560024 -0.032199712246921856 0.058190004420120581 -0.0093985964752230106 -0.19618740168525581 0.069554697204108382 0.078977981883280923 -0.11044537448072514 0.15371603145311277 0.11421578217152711 -0.18223692694437796 0.068264242273598119 -0.098152162042233232 0.13906065424667388 -0.17659424261478981 0.081042094901475376 -0.026676856408982055 -0.0022570953558071439 0.0091133365424962733 0.13346590956149729 -0.086178047059267585 -0.1357623295752495 0.044894923416373661 -0.026454295566883102 -0.094524489355242963 0.0022573040371246995 -0.1732200246036282 0.029129287325317915 0.040643433064882793 0.0012446503111712983 -0.2300741498102121 -0.090534777003372355 0.022090853333014641 -0.042735267704514773 0.12563985383370838 0.0084105278777452525 -0.13716002806003993 -0.017066704757458178 0.0046412721951837399 -0.16793074373005121 0.0032760280928821814 0.095833172533687491 0.027954008787856945 -0.16167721793708806 -0.023045246964563053 0.090582060182282667 -0.050759087778085535 0.070362437914398931 0.057268536343446336 -0.045282872893015101 -0.062777216291779445 0.1276658418369109 -0.24950262618589628 0.046396314294770973 -0.10299412316059502 0.14820614331511098 0.0098062252508216933 0.1494579362494303 0.13396490353502188 -0.09629893926547918 -0.044566915965668537 -0.17817772036486548 -0.022409780312826259 0.11986834881355518 -0.12909641205902822 -0.15701857410366643 0.033752646916126686 -0.18143802884662913 -0.17505198306027342 -0.027307335209274156 0.13938694048450856 -0.0094665395757679762 -0.093622566410033123 -0.076072309170353028 -0.12292417774452961 -0.21081198762901593 0.15734228582671039 0.15373772628779167 0.081865588416979274 0.01650464502117131 -0.27461872618072042 0.10871401915769133 0.005028730421101254 -0.25035900108835829 -0.24793260026715824 -0.17898166578698479 -0.15764461769472685 -0.15603956388107798 0.086254224433291213 0.088176527347129843 -0.17667279426758761 -0.17093931325445588 -0.10100851974622028 -0.11740190623768176 0.044963536625854013 -0.15410732688442016 0.098927084678318691 0.15905916998138386 -0.10937143829719154;0.054410524869774268 0.032835301571653153 -0.010724072202245818 -0.027221252751463927 0.13359710838303612 -0.012829712889343384 -0.17252704159001958 -0.10566512728595677 0.026993542224338238 -0.032547217450276396 0.10582019912922844 -0.17752082353146417 -0.17099979017796352 -0.033708637620362733 -0.14901082300122021 -0.21126123760967572 -0.12800172981913474 -0.12251065747425212 0.13468053223941567 -0.10835488184147309 0.29137857259157079 -0.22957181535009749 0.035929750802032125 0.46258842901910446 -0.097903625321501639 0.070829716151566594 0.087310328014812297 -0.11731190823429291 -0.14629425528475543 -0.045547768868046824 -0.063227036006605272 -0.17199317405057402 -0.10239467244173014 0.031007642022008158 -0.089351384528832831 -0.18787075022358277 0.17145623023586176 -0.17013280826501895 0.13294404599406323 0.15401847206114228 -0.14235571926565377 0.052039991534774864 0.10317916561621826 0.11902965127217741 0.030292308628969238 0.01890670757946224 0.075619477263583951 -0.061759761784244187 -0.19861175083276303 0.16251100395627499 0.075338816330155683 0.0047228439613189515 0.13166104640309806 -0.18839464540453088 0.015256781513261243 0.089518516313858959 -0.092105998884821724 0.02045934893699668 0.11091447505026207 -0.1548986846783687 0.062506444020322335 -0.18350246019061414 -0.18401011060435726 -0.022569778829658424 -0.13718657728267114 0.045728255650078375 0.13474493266241863 -0.069315074482625263 -0.14422350705844283 -0.082751768747870297 -0.14499095739431136 -0.17592070411481364 -0.19813381133072591 -0.23726493845504867 0.1128252756714181 0.078669538165093048 -0.12145163604168666 -0.063742659532745272 0.095996821796111839 -0.11324335551626748 -0.11294660539942948 -0.091436376422161084 -0.047387032337976344 -0.097330696192860514 -0.10223016456062727 0.014100770301482102 -0.078042224420039025 0.07082264586831355 0.054764737323372677 0.028985877967751931 -0.15462610393404783 0.2472255439954853 -0.00059135674216728392 -0.41487717164230037 0.020405268300551355 0.12217109559819073 0.029308373466317889 0.085208011439262751 0.1849042048757206 0.029326563838101376 -0.18257490200749446 0.14731839037291822 0.19107522100020996 0.13053638227667602 0.17430909682646442 0.059048047647228596 -0.083755111531282692 -0.060378812062280462 0.13204474608818337 -0.074304420477320082 0.1522626600309856 0.17202245269472979 0.067337969263488104 0.07983570729192295 -0.092338998692470836 0.092443842773250337 0.010893806763793935 0.10516827358125291 0.14074659872931436 -0.19726830417963051 -0.20717018653100489 0.10510871334283033 0.16427421586437471 0.21061646324539712 -0.069594972504143829 -0.05816610211068797 -0.022610988981868575 0.29256936365111025 0.074654115446254984 0.0081335671206758109 0.025161004286182759 -0.10449149979135179 0.059364063366331106 -0.058479550443613415 0.11620015410435865 -0.1397545516252876 -0.043998549711743905 0.15480178905825648 -0.0036922399065306187 0.026194997614043172 0.018263916001053777 -0.098671657238687885 0.092381678504414172 0.19091441002062357 0.048378072531823142 0.031523246123197984 0.16268718504782331 -0.11120215362391397 -0.052535377992866013 -0.1242246994612959 -0.1367974444155361 -0.072477938844193693 -0.080401650801844249 -0.10486818010647639 0.1653759337403434 0.084164297425139256 -0.052129397579380177 0.077137611448902438 -0.018034956158978127 -0.040288960407625272 0.10452598603555556 -0.096081853737682327 -0.10873579464322737 -0.0092254134534762496 0.22651757467040043 -0.065039486554634957 0.016392776963559817 0.11417577903844052 -0.1491056391924345 0.050896709171264196 -0.01012639740708602 -0.19300126993916467 0.14785170799736114;0.10996319878767842 0.074241895303433933 -0.01387386736722742 0.20578318218872219 0.029319078087200849 -0.10283825190964269 0.10110939538273837 0.048188555224342691 -0.09551928934685848 -0.0022415906233222028 -0.17457162404128052 0.15907464788430603 -0.10601225384993852 -0.062068605742032643 0.19333927307268467 0.062092640246568381 -0.051831642444112619 0.0096242756841966697 0.16625492556649957 -0.09733145081909586 0.0056766363273173673 -0.085104843433685864 -0.010095767542498276 0.17500708123756595 -0.050004792004648677 0.15553605872474854 0.068996288707158335 0.1954167558290234 0.14092340162606909 -0.0034210150700109037 0.0238775847694076 -0.051205586804448679 0.020111514999064925 -0.13415321545725148 -0.0088673248414483877 0.034312534134130004 0.10647370217843521 -0.028927370563584662 0.080390554004087927 0.011068332338020395 -0.022656766896775985 -0.08549427997053187 0.087677736085912075 -0.069251080258520697 -0.1156841731891403 0.076094139642584602 -0.095760030365469512 0.13914103797071897 0.18562079100939355 -0.11696737131920665 0.18580580494074955 -0.037237199632225791 -0.086112389139548509 -0.067887862544410246 0.160078966281478 0.12239094161279689 0.1124343773777717 -0.10511708911135746 0.16517176785572449 0.002543928140222381 0.071538514743605633 0.15396417233843759 -0.0040201011689436315 0.087643557361097219 0.027766280897938235 0.048148315270562153 0.11984355722580514 -0.003142298097184157 0.067020442226232588 -0.011360205669945724 -0.11610374985419751 0.043061915269452154 0.16685091539795247 -0.082634703658034575 -0.12524324209223242 0.13256842676800618 0.052990203335926633 -0.13530366016196943 -0.053682835600240231 -0.032375008163367164 -0.04568934046292538 0.030906957003716842 0.079347729417510948 0.10811711013763556 0.11391744209224716 -0.14763274293414239 -0.1146367557123408 0.033734822528192446 -0.039700019131939136 0.10481061297863646 0.020060802393447701 0.20966703506446288 -0.10518593207089642 0.14828106353419929 -0.041542172445089814 0.12995186147388244 0.056997262315891778 0.20695922488851917 -0.0053120776596873353 -0.11083475188514669 0.1076902920546125 -0.033461826988347119 -0.16940208336399412 0.029677213802303627 0.22132044559730796 -0.1029049631763832 -0.0020826172200585501 -0.11468164626521872 -0.17131653642308062 -0.12785505253991025 -0.15069590037047023 0.05750418768889768 -0.15386467584240449 0.064346260159651891 0.057968564736541016 0.18928011317493545 -0.18309509450377517 -0.14752787190996189 -0.18327484736468949 -0.17257440702160703 -0.064369042489105993 0.017616091122427398 0.050870693109774934 0.036595119579174641 0.13466405064519338 0.14743787147437226 0.08072875590385839 0.1098600384190402 -0.0091650940054641312 0.015253914293454728 0.10048975356691153 -0.013199527129457253 -0.19287096544667665 0.024156805938707494 -0.14101410466808548 0.05653009748832255 -0.1748211416550472 -0.12917182411261563 -0.014943985288065741 0.083202216835288764 0.10339079120962109 0.13905511444937099 0.060373473649645078 -0.15568866271525997 0.19339452052301512 -0.12339952455287485 0.12381012606822747 0.13405998661198856 -0.011896493013821337 -0.20312475590760079 -0.00025865889728402024 0.18824237575012678 -0.036375191667571825 0.14512005496248023 0.029684038917486874 0.13736331450995307 -0.019564290348865969 -0.031907111113018957 -0.079818342944077914 0.035242333687750427 -0.090503906564490894 -0.027563267846675964 -0.0081827958631373373 -0.084322784537349899 0.20542335499185291 0.0065688332548471517 0.12364263632852397 0.17681393225263595 0.13278772946899992 0.029160026004540384 -0.034141980665371073 0.033754985307825572 0.13072323192945173;-0.04290997103078692 -0.052189000860325262 0.032249980541648841 -0.068744389885407112 -0.14475229707629345 -0.11209205951733825 0.1522781518883243 -0.024493010116704083 0.04112887547875934 0.24737668215270917 -0.03033541528416123 0.04739574396935424 -0.16077071953703795 0.16901005939474065 0.14779818683376764 0.10996013613450735 0.028908176097445646 0.0070506576913285501 0.0040876435363389101 -0.13186979865498569 -0.30788029735097111 -0.043503302292850196 0.060311174679226483 -0.24608793627173065 0.03193381412618309 -0.03563492697655999 0.10390062133123812 0.054618949184503676 0.090917172490154352 0.083373651967449433 -0.059838958004956755 -0.12381263576485266 0.19389026156074488 -0.13010297156713202 0.19753506447036043 -0.093935881768016705 -0.055068279191705732 -0.10181242676642122 -0.19674761104966051 -0.065749239421440883 0.024470881853988796 0.050234981196885131 -0.18976414765941257 0.064057772518454459 0.095619621525620535 0.0083582819329425795 -0.14352151211284558 0.13692588571398837 0.079555655069372622 -0.15070998438919675 0.1936095598255709 0.02410677076530738 -0.03583411085858363 -0.048620701422472545 0.024226583540890818 -0.14798796454736779 0.12064484092416926 -0.030969766156361964 0.15658496499525185 0.1757668164769631 0.061361682724508003 0.0059426212785350079 -0.13510338845105038 0.018976091647667708 0.039092121589610999 -0.17513579265520574 -0.019972584881191746 0.06324158779994328 -0.076986631817840601 0.11116143397407302 0.13896562901524495 -0.052352578681680924 -0.13200072443991681 -0.14238914785930334 -0.043829927948479584 0.037059832487732494 0.1052711887511505 -0.21023774868077252 0.0082874257261411656 -0.076128591166275392 -0.0041422885735657757 -0.15638026027397878 0.092001406979890871 0.0043485972252279665 0.073976485873844339 0.053148228191626762 -0.11395161746841741 -0.067698802542454417 0.17063655158902338 -0.11283958617407625 0.16947182057503019 -0.049947141013440444 -0.20669846541842257 0.13139098998726267 -0.057877381901723979 0.044962915505101758 -0.014734776566189404 -0.032712476410103004 -0.3375455321418937 0.1295112421092349 -0.072002840318944786 -0.0053063450836107516 -0.0071442895755202433 0.080266229221683 -0.12988378908076947 -0.10314852382304514 -0.12669997843977762 -0.1512521806190098 -0.054670039918410122 0.073489098774229197 -0.16929625024922748 -0.16417130487073306 -0.0073902358852097529 0.095731797557425266 -0.046283084949112173 -0.2032952747472094 -0.041970006328897906 0.02409948528116625 0.19677615849513891 0.16590814183825212 -0.11247252208585248 0.055362374282759426 -0.16603522275686314 -0.26322788231607913 0.087257095777946714 0.11791089899116078 -0.028925183286493916 -0.20951246556168177 0.14144467462367882 0.088141604635970677 -0.086018601997882374 0.14495830872578283 0.078604233173973151 -0.0030340653212745589 -0.16127038207960498 0.10480620226211818 0.15820375692886884 -0.1066474770429259 0.16504468419181775 -0.057295682756097865 0.14890268681278424 -0.19937161352417337 -0.19132445973370638 0.10791641904585153 0.049271038788825536 0.1049242996507458 -0.11235929929477381 0.014967179930568229 -0.16904258321773985 -0.12217936444272612 -0.033041643890126836 0.11466780315725222 0.14140191329910498 -0.012073943313937883 -0.099431864828701408 0.12432310099833284 -0.087402593713751434 -0.28307829455445677 0.15436966261830026 0.079388901232934128 0.055369682113652265 -0.1115761154355714 0.030668014294769314 0.077498722096451866 0.021893755651190207 -0.18469777217005184 -0.16432555727167175 0.039402251869607732 -0.08432686498562969 -0.13714284763955348 0.10613046933222282 -0.031776971401202329 -0.011644229941281449;0.054571573519231469 0.098253765106109836 0.06249428091736605 -0.0029202004950261108 -0.12977253680735765 0.035574932535356894 -0.07959847630372581 -0.19696828298545072 0.07185895080702695 -0.25274879333391015 -0.094905785866932643 -0.020241193191917469 -0.11501541024959996 -0.083133577505238088 0.016471759825607842 -0.0039264557929560131 0.11870276328518384 0.070520876799985657 0.046693273942379501 -0.12615501712878441 -0.022670649311580627 -0.092501042648284779 -0.1314286145534245 0.06521728334895735 -0.19216260271560023 0.063755363289626832 0.10441691278759212 -0.015535851393014997 0.050253445817759 -0.13373037485405975 0.0019813101756664363 -0.006823984288027345 -0.081305043160828677 0.17284831727322386 -0.17199910538457916 -0.049135129467807223 0.0033168881443222638 -0.11748013911376895 -0.16795624063288128 -0.14266580444757207 -0.062041633710720967 0.082604479773462275 0.012024612737964884 0.0099257876113868233 -0.12884624898396224 -0.031264597848252605 0.017048708430525639 -0.11640448149186752 -0.051200858151124413 -0.15301952239169217 -0.15556280811009179 0.11347029455542593 0.059660653279460678 -0.081161109477716736 -0.071962525351783213 0.081793120268309011 0.10660246236800143 -0.15148997213542581 -0.19651318346009089 -0.015031427921858114 0.13992969821336851 0.086931180502093724 -0.13751257280757676 -0.024353312393503787 -0.022897243278312874 0.14085181979302072 -0.10618308251756986 -0.20974856882168316 0.17027891158819713 0.069661583537235422 0.082336747917857084 -0.18813161286004829 -0.15078120791863195 -0.043979151848805957 0.011088224779159531 0.12589233510756687 -0.16660307783350814 0.12735283057781999 0.083127504009493022 0.060365260310725789 -0.10175466538360632 -0.05745736129316014 -0.020404412487656134 -0.14298216311990594 -0.1401147668056465 -0.16748407337922483 0.15221208922361132 -0.1593570709564659 -0.032095168592523197 0.011696341083295545 -0.055159097661737537 -0.096916493659485528 0.10102605104321867 -0.05463337538513547 -0.12296835185371748 -0.063387209876165904 -0.041854639978603142 -0.1814108883063697 -0.1057506664148482 -0.13575881421101804 0.025290969713542381 0.010757701005683133 -0.18727318441893265 0.1498383072214288 -0.04334502668717978 0.078141007282501687 0.013799558741540627 -0.061284371982831536 0.063829136231595404 0.1125570216940447 -0.00066749076723460264 -0.047062647605239552 0.11015747469742292 -0.029271578745764228 0.059218380546349848 -0.046491952019781159 -0.0672898031239582 -0.043442477071587896 -0.15707271064356845 0.063390223000795817 0.092651857581493788 0.15672360218991946 0.14288040648150918 0.02115742964750008 0.011928438877424266 0.0088642199908289462 -0.093702855976054086 0.062641215121398433 0.18969211843912065 -0.22427724999836346 -0.11732150322659446 0.034015801239922518 -0.05726145376301954 -0.020230465504802782 -0.18763310877187594 0.19935044899211138 -0.21459583238188901 0.15911344337250688 0.018357075428536145 0.14452850035228976 0.10420073535574786 0.13693065496979875 -0.18978385486557822 -0.11861054368079667 -0.16200292790550183 0.055594871952494296 -0.07412849132229439 -0.087979752206716874 -0.028490511226944341 -0.13812506822000092 -0.028406863087382717 -0.18700873450705613 0.1199312422000285 0.14978552268404965 -0.10680017655688089 -0.20511488758528329 -0.07127105590870314 -0.099825376653730202 0.10585902074922807 0.044405575921428575 0.11951764477940388 -0.14596051609977867 -0.18715386928280503 -0.12512902924284058 0.095504600539925336 0.073922020450834514 -0.1595019414737843 -0.080970059568973088 -0.069057118280165225 -0.12372799146688669 -0.077642794335658474 -0.069605157516674107 0.047471773401620496;-0.095264017473203483 -0.12048731645919833 0.10166054498531302 -0.10511958952935072 -0.064590984020768766 -0.069093441743198675 0.16983473010163988 -0.1129706486674863 0.11301306286679931 0.14818012105934006 0.18072981790533199 -0.091894071121828166 -0.079719612269723128 -0.1061731057968216 -0.16706407269114346 0.05864349776229108 -0.14499178183839811 0.15223538639778797 0.034190465846505924 -0.049969663189639697 -0.24430903898689454 0.081477544842725957 0.074283297968049722 -0.3614613941167516 0.059799215258292605 -0.041236314859305775 -0.016855317603130547 0.0071071585750257429 -0.15501700890292269 -0.17910692620731195 0.044855645878964769 -0.028822948768669535 0.25772515784824318 -0.058890502582941755 0.15737583160226046 0.093944763464977779 -0.13452237919908872 -0.12611165269178784 -0.14403979932014599 0.095628681390965642 0.18826075591800709 -0.14187627311669668 -0.051844851722689198 -0.19239354836504657 0.15960263491827428 0.081263847719709861 -0.020729392498447151 0.11493866586163447 0.10879763119016882 -0.12366307362093171 -0.10928929207392026 -0.017385939022624544 -0.11231018469683336 -0.090130785875399688 -0.29758501871733262 0.19970608790164995 -0.023360408864416402 -0.20170878838494832 0.13253367218431747 0.18168159662716662 0.16842993175440596 -0.081831875066394874 -0.087803662339098948 0.0070160031064938891 -0.08080402236656406 0.066399775917591511 -0.025007849015181095 0.14189661416312821 -0.11260569430610208 -0.11507507591485651 0.006411607742590233 -0.065132425146821119 -0.051907055448739692 0.17926453926681585 -0.27020570018745527 -0.20011617480993701 -0.098634110887428988 -0.011187632930879945 -0.033907968839417865 -0.020808987337128017 0.074257025187978193 -0.16772435658191417 0.1008820456312257 -0.10305073705986229 -0.10272175705894222 -0.15495785961199332 0.099349280275943599 0.045263854941682551 0.077428229391958286 0.011560477329933316 0.14256656250398111 0.0061036826022563542 -0.15209920604080315 0.12530261995834993 -0.075560727627699165 -0.059088402453971151 0.20044299204134339 0.10709221444745691 -0.2921915975781591 0.12205131948011735 -0.04560344224773593 -0.0088440158248378857 0.070756282190023362 0.0062438489185325831 -0.02905582832404674 0.01560558303668801 0.31192335635026086 0.11195090907196296 0.046091152607324042 0.14916236220864038 0.080184793308775898 -0.14829105962421343 0.22466944681309853 0.10194522468639687 -0.017864091183203017 0.078366807208787845 -0.062088361572870919 0.14314188167825304 0.090460355958909916 -0.073108879537762642 -0.079139635654514123 -0.13911798827387478 0.083548506178269866 -0.31279916740348823 -0.14495031900884464 0.079030548695629019 0.14486339921793839 -0.35439199164932672 0.10022572022932175 0.28576091511962215 -0.20343244545469932 0.23437880231324418 0.0023111752444117061 -0.024062817643188312 -0.12078903730729236 0.041881921446888286 0.0027023617145517567 0.067953316291927635 0.046154432512893549 0.086351080409803438 0.034382398413356247 -0.15290455252537094 -0.17785425253907478 -0.019211970599105621 -0.068430909250319555 -0.069784925113273166 -0.14385480929306185 0.034542998866577454 0.032962731495422927 -0.066853438390207326 -0.062586664802001854 0.13636646884995446 -0.068511156556141789 -0.11538941572999961 -0.28436204440726848 0.06299697873319085 0.13948002850847011 -0.28541233080083039 -0.073227816678973892 0.11300564920849065 -0.052457676168248112 -0.064086083514782594 0.036632274171640854 0.19476589448125881 -0.22384678313443765 0.044382877242772754 -0.12541245788876232 -0.13503840003051104 0.022532452588982337 0.021966793000862659 -0.013466154778916177 -0.04102321134666928 0.032875213195174807;0.08096198507275694 -0.032416099697960908 -0.084317519095179358 0.079170319484787519 0.13062450021635943 -0.078233323564363536 -0.1425306467653597 -0.15088454125388995 -0.010111628498942333 -0.1612001218736771 -0.011961142848166606 0.11673381448469179 -0.023420130655328001 0.089378243385134143 -0.10028287778063032 0.0066199782119981121 0.17298032746156664 0.039621170187710684 -0.11056825681473273 -0.092614132960692291 0.0094504905433826364 -0.17075238042182453 0.19375617230079015 -0.21086565443053973 -0.16408668046615199 -0.17149601789859051 -0.13736739779987955 -0.15785930075271271 0.04450337702391173 -0.14120803859875516 -0.092398101872861876 0.18019316693676238 -0.091223272159843383 -0.16537248628652118 0.040443445088168647 -0.081498287838630529 0.13612447860890001 -0.0223490514172014 -0.0076897203625915234 0.11954332766282308 -0.0096764293809798955 -0.084289560108114517 0.13946676852780662 -0.11965849306347737 -0.10470531462867173 0.067461868943298378 -0.035076917698575967 0.046981998942184584 0.0011588979237735285 -0.026636352221392677 0.056961940171615953 -0.05579995213770253 0.071751444491520322 0.13074075565703244 0.094566175580157619 -0.0080442703097124875 0.01362310014110428 0.11129130712070193 0.043973932270965049 0.074523377078164074 0.10823539550278764 0.002339124412755785 -0.12350063136210139 -0.16125978574621849 0.1815243442940328 0.071244074006945574 -0.13004363774487998 0.0028244802477581711 0.19771164163997437 -0.13763614648933509 0.16380460843703729 0.13644721152727832 -0.0088665769323654064 0.033326121098344035 0.060143935164093457 0.051008658903162148 0.020643459179309154 0.047297371252217994 0.086432935367357813 0.092077826722189851 0.0024745662238258321 -0.16691257785779351 -0.13778525585693599 0.055282197678048012 -0.14647501097650262 -0.1707219545820014 0.028728165713385354 0.16864419155269925 -0.12209665821817085 0.018989049811306166 -0.12278476211793224 0.078051923566006334 -0.13776969847862106 0.11379659934097418 -0.17415279473609602 0.078378513595361257 -0.055261378213887963 0.02879067331336907 -0.15897133584072581 -0.11858237650502955 0.036157723119708399 -0.08973809432423703 0.1680586989671537 -0.14249351554681711 0.15116621459798546 -0.025022552725781098 -0.070061198321796317 0.11422609406775604 -0.12516228290813797 -0.14692868049155108 -0.090027248607318353 0.012906886159061097 0.067721533025624461 0.13262833119199929 -0.020828133145758047 -0.074186236498907349 0.065818493788825344 0.010194494695036535 0.01550911784833079 -0.025779668587003431 0.14893715907657484 -0.063362719461303466 -0.10117724841531343 -0.051239144212821532 -0.1817245810332857 0.15059984044515712 0.11415299062544768 -0.056852418208061195 -0.060766154219535018 -0.028412421201583899 -0.10741426052609455 0.054099439877916995 -0.16414218119971211 0.011891911906918601 -0.085229299119382568 0.19477110257160632 0.1091439930132535 0.011371219920970538 0.064862158807758988 -0.045895352255982971 -0.16951914025449069 0.071418326157009021 -0.20203989729687069 -0.13245783202004013 -0.0051182908344057226 0.16630884332376458 0.11321425712827363 -0.11877474823467821 -0.11637153033534796 -0.11503210917223783 -0.18282780851807817 0.094517929349424837 -0.091059109856903034 0.026368011767004242 -0.11547063037569119 -0.1147242270996265 0.087780215027966318 0.041015183628107584 -0.19366229482513311 0.097610118593977557 -0.13211915217432435 -0.1627289793915713 0.032566428340389225 0.051410726318748351 0.0072619280719124464 0.022254714822730396 -0.012060093296709342 0.13362368643431408 0.11019425938927849 0.16687960211691807 0.060995886170306934 0.1121757627464474 0.10004084176448047];
  
  % Layer 2
  b2 = 0.24377299646983677;
  LW2_1 = [-0.32664554600515389 -1.484635238125652 0.31721840242828842 1.2977679796987265 -1.2958220308112303 -0.27171963097255009 0.9373871788477075 -1.0073231054082901 1.4043502209230097 0.96101620201868776];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    temp = removeconstantrows_apply(X{1,ts},x1_step1_keep,x1_step1_remove);
    Xp1 = mapminmax_apply(temp,x1_step2_gain,x1_step2_xoffset,x1_step2_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings_keep,settings_remove)
  if isempty(settings_remove)
    y = x;
  else
    y = x(settings_keep,:);
  end
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
